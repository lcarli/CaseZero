# CaseZero API - Teste de Autenticação JWT

### 1. Registro de novo usuário
POST http://localhost:5029/api/auth/register
Content-Type: application/json

{
  "email": "detective@casezero.com",
  "username": "detective1",
  "password": "Detective123!",
  "firstName": "João",
  "lastName": "Silva",
  "department": "Investigação Criminal"
}

### 2. Login com usuário admin (criado automaticamente)
POST http://localhost:5029/api/auth/login
Content-Type: application/json

{
  "email": "admin@casezero.com",
  "password": "Admin123!"
}

### 3. Login com usuário detective
POST http://localhost:5029/api/auth/login
Content-Type: application/json

{
  "email": "detective@casezero.com",
  "password": "Detective123!"
}

### 4. Obter perfil do usuário (requer autenticação)
GET http://localhost:5029/api/auth/profile
Authorization: Bearer {{token}}

### 5. Listar casos (requer autenticação)
GET http://localhost:5029/api/cases
Authorization: Bearer {{token}}

### 6. Obter caso específico (requer autenticação)
GET http://localhost:5029/api/cases/1
Authorization: Bearer {{token}}

### 7. Criar novo caso (requer permissão de Supervisor ou Admin)
POST http://localhost:5029/api/cases
Authorization: Bearer {{admin_token}}
Content-Type: application/json

{
  "title": "Roubo na Loja Central",
  "titleEn": "Central Store Robbery",
  "description": "Investigação de roubo em loja do centro da cidade",
  "descriptionEn": "Investigation of robbery in downtown store",
  "difficulty": 2,
  "estimatedTimeMinutes": 120,
  "isPublished": true
}

### === EVIDENCE ENDPOINTS ===

### 8. Listar evidências de um caso
GET http://localhost:5029/api/evidence/case/1
Authorization: Bearer {{token}}

### 9. Obter evidência específica
GET http://localhost:5029/api/evidence/1
Authorization: Bearer {{token}}

### 10. Criar nova evidência (requer permissão de Analyst ou superior)
POST http://localhost:5029/api/evidence
Authorization: Bearer {{admin_token}}
Content-Type: application/json

{
  "caseId": 1,
  "evidenceNumber": "EVD-001",
  "name": "Câmera de Segurança",
  "nameEn": "Security Camera",
  "description": "Gravação da câmera de segurança do estabelecimento",
  "descriptionEn": "Security camera recording from the establishment",
  "type": 3,
  "category": 1,
  "location": "Entrada principal da loja",
  "locationEn": "Main entrance of the store",
  "collectedBy": "Detective Silva",
  "filePath": "/evidence/camera_footage_001.mp4",
  "content": "Vídeo mostra suspeito entrando na loja às 14:30",
  "contentEn": "Video shows suspect entering store at 14:30",
  "isAvailable": true,
  "requiresAnalysis": true,
  "tags": "video,security,entrance"
}

### 11. Atualizar evidência
PUT http://localhost:5029/api/evidence/1
Authorization: Bearer {{admin_token}}
Content-Type: application/json

{
  "evidenceNumber": "EVD-001-Updated",
  "name": "Câmera de Segurança - Atualizada",
  "nameEn": "Security Camera - Updated",
  "description": "Gravação da câmera de segurança do estabelecimento - versão processada",
  "descriptionEn": "Security camera recording from the establishment - processed version",
  "type": 3,
  "category": 1,
  "location": "Entrada principal da loja",
  "locationEn": "Main entrance of the store",
  "collectedBy": "Detective Silva",
  "filePath": "/evidence/camera_footage_001_processed.mp4",
  "content": "Vídeo processado mostra suspeito entrando na loja às 14:30",
  "contentEn": "Processed video shows suspect entering store at 14:30",
  "isAvailable": true,
  "requiresAnalysis": false,
  "tags": "video,security,entrance,processed"
}

### 12. Alternar disponibilidade da evidência
POST http://localhost:5029/api/evidence/1/toggle-availability
Authorization: Bearer {{admin_token}}

### 13. Listar evidências que requerem análise
GET http://localhost:5029/api/evidence/requiring-analysis
Authorization: Bearer {{admin_token}}

### === ANALYSIS ENDPOINTS ===

### 14. Listar todas as análises
GET http://localhost:5029/api/analysis
Authorization: Bearer {{admin_token}}

### 15. Obter análise específica
GET http://localhost:5029/api/analysis/1
Authorization: Bearer {{admin_token}}

### 16. Listar análises de uma evidência
GET http://localhost:5029/api/analysis/evidence/1
Authorization: Bearer {{token}}

### 17. Criar nova solicitação de análise
POST http://localhost:5029/api/analysis
Authorization: Bearer {{admin_token}}
Content-Type: application/json

{
  "evidenceId": 1,
  "sessionId": 1,
  "type": 1,
  "estimatedTimeMinutes": 120,
  "notes": "Análise forense do vídeo para identificação do suspeito"
}

### 18. Atualizar resultado da análise
PUT http://localhost:5029/api/analysis/1
Authorization: Bearer {{admin_token}}
Content-Type: application/json

{
  "status": 2,
  "result": "Identificado suspeito do sexo masculino, aproximadamente 1.80m de altura",
  "resultEn": "Identified male suspect, approximately 1.80m tall",
  "notes": "Análise completa. Características físicas bem visíveis no vídeo."
}

### 19. Listar análises pendentes
GET http://localhost:5029/api/analysis/pending
Authorization: Bearer {{admin_token}}

### 20. Listar análises por status (1=Pending, 2=Completed, 3=InProgress)
GET http://localhost:5029/api/analysis/status/2
Authorization: Bearer {{admin_token}}

### === USER MANAGEMENT ===

### 21. Listar todos os usuários (Admin only)
GET http://localhost:5029/api/users
Authorization: Bearer {{admin_token}}

### 22. Obter usuário específico (Admin only)
GET http://localhost:5029/api/users/1
Authorization: Bearer {{admin_token}}

### 23. Atualizar perfil de usuário
PUT http://localhost:5029/api/users/2
Authorization: Bearer {{admin_token}}
Content-Type: application/json

{
  "firstName": "João Carlos",
  "lastName": "Silva Santos",
  "department": "Investigação Criminal - Homicídios",
  "role": "Detective"
}

### 24. Desativar usuário (Admin only)
DELETE http://localhost:5030/api/users/2
Authorization: Bearer {{admin_token}}

### === INVESTIGATION SESSION ENDPOINTS ===

### 25. Iniciar nova sessão de investigação
POST http://localhost:5030/api/investigationsession/start
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "caseId": 1,
  "notes": "Iniciando investigação do caso tutorial"
}

### 26. Listar minhas sessões de investigação
GET http://localhost:5030/api/investigationsession/my-sessions
Authorization: Bearer {{token}}

### 27. Obter sessão específica
GET http://localhost:5030/api/investigationsession/1
Authorization: Bearer {{token}}

### 28. Atualizar progresso da sessão
PUT http://localhost:5030/api/investigationsession/1/progress
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "hintsUsed": 2,
  "evidencesViewed": 5,
  "analysesRequested": 1,
  "sessionData": "{\"currentStep\": \"analyzing_evidence\", \"progress\": 60}",
  "notes": "Progresso: analisando evidências do local do crime"
}

### 29. Finalizar sessão de investigação
POST http://localhost:5030/api/investigationsession/1/end
Authorization: Bearer {{token}}
Content-Type: application/json

{
  "score": 85,
  "notes": "Caso resolvido com sucesso. Identificado o suspeito através das evidências."
}

### 30. Listar todas as sessões (Admin/Supervisor only)
GET http://localhost:5030/api/investigationsession
Authorization: Bearer {{admin_token}}

### 31. Listar sessões por caso (Admin/Supervisor only)
GET http://localhost:5030/api/investigationsession/case/1
Authorization: Bearer {{admin_token}}

### 32. Obter estatísticas das sessões (Admin/Supervisor only)
GET http://localhost:5030/api/investigationsession/statistics
Authorization: Bearer {{admin_token}}

### === VARIABLES FOR TESTING ===
# Após fazer login com admin, copie o token para usar nos endpoints protegidos
# @admin_token = YOUR_ADMIN_TOKEN_HERE
# @token = YOUR_USER_TOKEN_HERE

{
  "title": "Roubo na Joalheria Central",
  "titleEn": "Central Jewelry Store Robbery",
  "description": "Uma joalheria foi assaltada no centro da cidade.",
  "descriptionEn": "A jewelry store was robbed in the city center.",
  "type": 1,
  "difficulty": 2,
  "status": 1,
  "estimatedTimeMinutes": 45,
  "isPublished": true,
  "isTutorial": false,
  "location": "Rua das Flores, 123",
  "locationEn": "Flores Street, 123",
  "tags": "robbery,jewelry,city-center"
}

### 8. Tentar deletar caso sem permissão (deve falhar)
DELETE http://localhost:5029/api/cases/1
Authorization: Bearer {{detective_token}}

### 9. Deletar caso com permissão de admin
DELETE http://localhost:5029/api/cases/2
Authorization: Bearer {{admin_token}}

### 10. Logout
POST http://localhost:5029/api/auth/logout
Authorization: Bearer {{token}}
